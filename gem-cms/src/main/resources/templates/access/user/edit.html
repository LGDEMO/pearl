<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>无标题文档</title>
    <div th:replace="common/links::common_links"></div>
    <div th:replace="common/links::custom_links"></div>
    <div th:replace="common/links::font_links"></div>
    <div th:replace="common/links::ztree_links"></div>
    <div th:replace="common/links::multiselect_links"></div>
    <div th:replace="common/links::tabs_links"></div>
    <div th:replace="common/links::checkbox_links"></div>
    <div th:replace="common/links::validate_links"></div>
</head>
<body style="border-radius: 8px;width: 690px;overflow: hidden">
<form id="form" onsubmit="return false">
    <div class="top">
        <div>
            <div class="top_out">
                <table class="table">
                    <tbody>
                    <tr>
                        <td>用户帐号<span class="span">*</span></td>
                        <td><input type="text" id="username" name="username" required   minlength ="2"></td>
                        <td>用户密码<span class="span">*</span></td>
                        <td>
                            <input type="password" id="password" name="password" class="long_text" value="123456" placeholder="默认123456" required>
                        </td>
                    </tr>
                    <tr>
                        <td>员工工号<span class="span">*</span></td>
                        <td><input type="number" id="worknum" name="worknum" required maxlength="5"></td>
                        <td>所在岗位<span class="span"></span></td>
                        <td>
                            <select id="post" name="post">
                                <option value="1">初级人员</option>
                                <option value="2">中级人员</option>
                                <option value="3">高级人员</option>
                                <option value="4">领导班子</option>
                            </select>
                        </td>
                    </tr>
                    <tr>

                        <td>员工姓名<span class="span">*</span></td>
                        <td><input type="text" id="realname" name="realname" required></td>
                        <td>员工性别<span class="span"></span></td>
                        <td>
                            <select id="sex" name="sex">
                                <option value="0">男</option>
                                <option value="1">女</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>出生年月<span class="span"></span></td>
                        <td><input type="date" id="birthday" name="birthday"></td>
                        <td>户口籍贯<span class="span"></span></td>
                        <td>
                            <select id="input_province"  name="province"class="td_select">
                                <option value="">-请选择-</option>
                            </select>
                            <select id="input_city" name="city" class="td_select">
                                <option value=""></option>
                            </select>
                            <select id="input_area" name="area" class="td_select">
                                <option value=""></option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>通讯地址<span class="span">*</span></td>
                        <td colspan="3">
                            <input type="text" id="address" name="address" class="block" required minlength="5" maxlength="50">
                        </td>
                    </tr>
                    <tr>
                        <td>手机号码<span class="span">*</span></td>
                        <td><input type="tel" id="phone" name="phone" required></td>
                        <td>座机号码<span class="span"></span></td>
                        <td><input type="text" id="tel" name="tel"></td>
                    </tr>
                    <tr>
                        <td>电子邮箱<span class="span">*</span></td>
                        <td><input type="email" id="email" name="email" required></td>
                        <td>QQ/微信<span class="span"></span></td>
                        <td><input type="text" id="qq" name="qq"></td>
                    </tr>
                    <tr>
                        <td>其他备注<span class="span"></span></td>
                        <td colspan = "8" style="text-align: left">
                            <textarea id="desp" name="desp"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td>归属部门<span class="span"></span></td>
                        <td>
                            <div class="dropdown">
                                <input class="dropdown_select"  id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" placeholder="--请选择--" >
                                <span class="caret"></span>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenu1" style="width: 247px">
                                    <div class=" order_ztree l_left organize_ztree" style="width: 100%;background-color: #fff;padding-bottom: 10px;height: 240px;overflow: auto;">
                                        <ul id="treeDemo" class="ztree"  style=" overflow:auto;margin-left: 20px"></ul>

                                    </div>
                                </div>
                            </div>
                        </td>
<!--                        <td>授予角色<span class="span"></span></td>-->
<!--                        <td>-->
<!--                            <select  class="multiselect" multiple="multiple">-->
<!--                                <option>全部</option>-->
<!--                                <option>超级管理员</option>-->
<!--                                <option>普通管理员</option>-->
<!--                            </select>-->
<!--                        </td>-->
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!--底部按钮-->
    <div class="notice_bot">
        <div class="l_left"></div>
        <div class="r_right but_p">
            <button id="btn_edit" class="btn_edit" type="button" onclick="editData()">立即修改</button>
            <button class="but_close" onclick="Colse()">关闭</button>
        </div>
    </div>
</form>
<div th:replace="common/links::common_script"></div>
<div th:replace="common/links::table_script"></div>
<div th:replace="common/links::ztree_script"></div>
<div th:replace="common/links::multiselect_script"></div>
<script type="text/javascript" th:src="@{/static/access/js/custom/depttree.js}"></script>
<script type="text/javascript" th:src="@{/static/access/js/custom/address.js}"></script>
<script src="https://cdn.bootcss.com/jquery-validate/1.19.1/jquery.validate.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-validate/1.19.1/localization/messages_zh.min.js"></script>
<div th:replace="common/links::validate_script"></div>
<script>
    $(function () {
        $('.multiselect').multiselect({
            buttonClass: 'btn',
            buttonWidth: 'auto',
            buttonText: function(options) {
                if (options.length == 0) {
                    return '请选择角色';
                }
                else {
                    var selected = '';
                    options.each(function() {
                        selected += $(this).text() + ',';
                    });
                    return selected.substr(0, selected.length -1) ;
                }
            },
        });
    });


    var ajaxData = JSON.stringify($('#form').serializeObject());
    function editData() {
        $.ajax({
            type: "post",
            url: "add",
            // data: JSON.stringify($('#form').serializeObject()),
            data: ajaxData,
            async:true, // 异步请求
            cache:false, // 设置为 false 将不缓存此页面
            dataType: "json", // 返回对象
            contentType:"application/json;charset=UTF-8",
            success: function(res) {
                console.log("res.code=="+res.code);
                console.log("res=="+JSON.stringify(res));
                if (res.code == "0") {
                    if($("#btn_save_close").is(':checked')){
                        alert("保存成功",Colse);
                    }
                }else {
                    layer.alert("["+res.code+"]"+res.msg, {
                        skin: 'layui-layer-lan'
                        ,closeBtn: 0
                        ,anim: 4 //动画类型
                    });
                }
            },
            error: function(e) {
                // 请求失败函数
                console.log("error:"+JSON.stringify(e));
            }
        })
    }


    function Colse() {
        var index = parent.layer.getFrameIndex(window.name);
        parent.layer.close(index);
    }
</script>
</body>
</html>
